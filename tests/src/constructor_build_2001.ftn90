program constructor
  use vGrid_Descriptors, only: grid_descriptor,gd_new,gd_get,GD_ERROR
  use Unit_Testing, only: ut_report

  implicit none

  type(grid_descriptor) :: d
  integer :: stat,i
  integer, dimension(:), allocatable :: ip1s
  real(kind=8), dimension(4) :: pres=(/1000.,925.,850.,700./),b=(/0.,0.,0.,0./)
  real*8, dimension(:,:,:), pointer :: tbl

  ! Construct a new set of 3D coordinate descriptors
  pres = pres*100. !convert mb to Pa
  allocate(ip1s(size(pres)))
  do i=1,size(ip1s)
     call convip(ip1s(i),pres(i),2,2,'',.false.)
  enddo
  stat = gd_new(d,kind=2,version=1,nk=size(pres),ip1_m=ip1s,a_m_8=pres,b_m_8=b)
  stat = gd_get(d,key='VTBL - vertical coordinate table',value=tbl)
  call ut_report(abs(tbl(2,2,1)-pres(1)) < epsilon(pres),'Grid_Descriptors::gd_new vertical build initializer (2001) value')

end program constructor
