program constructor
  use Grid_Descriptors, only: grid_descriptor,gd_new,gd_get,GD_ERROR
  use Unit_Testing, only: ut_report

  implicit none

  type(grid_descriptor) :: d
  integer :: stat,i,ip1
  integer, dimension(:), allocatable :: ip1s
  real(kind=8), dimension(4) :: pres=(/1000.,925.,850.,700./),b=(/0.,0.,0.,0./)

  ! Construct a new set of 3D coordinate descriptors
  pres = pres*100. !convert mb to Pa
  allocate(ip1s(size(pres)))
  do i=1,size(ip1s)
     call convip(ip1s(i),pres(i),2,2,'',.false.)
  enddo
  stat = gd_new(d,kind=2,version=1,nk=size(pres),ip1=999,ip1_m=ip1s,a_m_8=pres,b_m_8=b)
  stat = gd_get(d,key='IP_1',value=ip1)
  call ut_report(ip1==999,'Grid_Descriptors::gd_new vertical build initializer (2001) value')

end program constructor
